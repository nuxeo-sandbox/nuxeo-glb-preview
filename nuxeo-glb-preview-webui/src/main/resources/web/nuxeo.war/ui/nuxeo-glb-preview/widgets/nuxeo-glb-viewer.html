<!-- Import the component -->
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<!--
`nuxeo-glb-viewer`
@group Nuxeo UI
@element nuxeo-glb-viewer
-->
<dom-module id="nuxeo-glb-viewer">
    <template>
        <style include="nuxeo-styles">
            :host {
                display: block;
                width: 100%;
                height: 100%;
            }

            model-viewer {
                width: 100%;
                height: 100%;
            }
        </style>

        <model-viewer src="[[_getSource(document,xpath)]]" poster="[[_getThumbnail(document)]]"
                      alt="[[document.title]]" ar ar-modes="webxr scene-viewer quick-look"
                      environment-image="neutral" shadow-intensity="0" shadow-softness="0" exposure="0.92" auto-rotate camera-controls>
        </model-viewer>

    </template>

    <script>
        Polymer({
            is: 'nuxeo-glb-viewer',
            behaviors: [Nuxeo.LayoutBehavior],
            properties: {
                document: {
                    type: Object
                },

                xpath: {
                    type: String,
                    value: "file:content"
                },

                thumbnailUrl: {
                    type: String
                }
            },

            _getSource: function (document, xpath) {
                return document && xpath && document.properties[xpath] ?
                    document.properties[xpath].data : undefined;
            },

            _getThumbnail: function (document, thumbnailUrl) {
                if (thumbnailUrl) {
                    return thumbnailUrl
                } else if (document) {
                    return document.contextParameters.thumbnail.url;
                } else {
                    return undefined;
                }
            }

        });
    </script>
</dom-module>
